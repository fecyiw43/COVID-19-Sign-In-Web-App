<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- initialisation -->
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- title of app -->
    <title>Keep Your Distance</title>

    <!-- bootstrap4 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous"/>

    <!-- w3school stylesheet -->
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="stylesheets/healthSignUp.css" />
    <link rel="javascript" href="javascripts/healthSignUp.js"/>
  </head>


  <!-- body -->
  <body class="background" onload="CheckId()">

    <!--logo & button style -->
    <div class="w3-bar w3-red w3-card w3-left-align w3-large">
    <a class="w3-bar-item w3-button w3-hide-medium w3-hide-large w3-right w3-padding-large w3-hover-white w3-large w3-red" href="javascript:void(0);" onclick="miniMenu()" title="Toggle Navigation Menu"><i class="fa fa-bars"></i></a>

      <!--logo-->
      <img class="w3-bar-item logo" src="images/wdc-project-logo.png" alt="KYD Logo">


      <!--buttons-->
      <div>
      <a href="kyd.html" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white">Home</a>
      <a href="/check-in-history.html" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white" id="checkInHistory">Check-in-History</a>
      <a href="/venManage.html" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white" id="venueInfo">Venue information</a>
      <a href="/manage.html" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white" id="manage">Manage</a>
      <a href="/account.html" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white" id="account">Account</a>
      <a href="/healthSignUp.html" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-white" id="healthSignUp">Sign-up</a>
      <a href="/login.html" class="button-resize w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white" onclick="logout()">Log Out</a>
    </div>

    <!-- Navbar on small screens -->
    <div id="miniMenu" class="w3-bar-block w3-white w3-hide w3-hide-large w3-hide-medium w3-large">
      <a href="/kyd.html" class="w3-bar-item w3-button w3-padding-large">Home</a>
      <a href="/check-in-history.html" class="w3-bar-item w3-button w3-padding-large" id="checkInHistory2">Check-In History</a>
      <a href="/venManage.html" class="w3-bar-item w3-button w3-padding-large" id="venueInfo2">Venue Information</a>
      <a href="/manage.html" class="w3-bar-item w3-button w3-padding-large" id="manage2">Manage</a>
      <a href="/account.html" class="w3-bar-item w3-button w3-padding-large" id="account2">Account</a>
      <a href="/healthSignUp.html" class="w3-bar-item w3-button w3-padding-large" id="healthSignUp2">Sign-up</a>
      <a href="/login.html" class="w3-bar-item w3-button w3-padding-large" onclick="logout()">Log Out</a>
    </div>
    </div>
  <p id="test"></p>
    <!-- Register title -->
    <h2 id="title" style="text-decoration: underline">Register</h2>

    <!-- Register form -->
    <div id="regDiv">
        <div id="regForm">
            <br>
            <!-- Input for First Name -->
            <label for="firstName">First Name:</label>
            <br>
            <input type="text" id="firstName" name="firstName" class="form-control" placeholder="John" required>
            <br><br>
            <!-- Input for Last Name -->
            <label for="lastName">Last Name:</label>
            <br>
            <input type="text" id="lastName" name="lastName" class="form-control" placeholder="Smith" required>
            <br><br>
            <!-- Input for Email -->
            <label for="email">Email:</label>
            <br>
            <input type="text" id="email" name="email" class="form-control" placeholder="example@example.com" required>
            <br><br>
            <!-- Input for Phone Number -->
            <label for="phoneNum">Phone Number:</label>
            <br>
            <input type="text" id="phoneNum" name="phoneNum" class="form-control" placeholder="0412123123" required>
            <br><br>
            <!-- Input for Password Number -->
            <label for="phoneNum">Password:</label>
            <br>
            <input type="text" id="password" name="password" class="form-control" required>
            <br><br>
            <!-- Input for Health Code -->
            <label for="healthCode">Health Code:</label>
            <br>
            <input type="text" id="healthCode" name="healthCode" class="form-control" placeholder="Gov health ID no#..." required>
            <br><br>
            <div id="buttonDiv">
                <!-- Button to register user -->
                <button class="btn btn-primary centerButton" onclick="RegisterHealth()">Register</button>
                <!--<input type="submit" value="Register" class="btn btn-primary centerButton" onclick="RegisterHealth()">-->
            </div>
        </div>

        <!--<button value="Register" class="btn btn-primary centerButton" form="regForm" type="submits" onclick="RegisterHealth()"></button>-->

    </div>

    <!-- footer -->
    <footer>
      <div class="about_us">
      <ul>
        <LI>ABOUT US</LI>
        <li>
        <p>
            Aninda Lachlan Frank Thomas
        </p>
        </li>
        </ul>
        </div>

      <div class="link_ref">

        <a class="links" target="_blank"
        href="https://www.sahealth.sa.gov.au/wps/wcm/connect/public+content/sa+health+internet/conditions/infectious+diseases/covid-19/testing+and+tracing/contact+tracing/contact+tracing%22%3E">
           Visit SA Health for more information
        </a>
        </div>
        <div class="link_ref">
        <a class="links" target="_blank" href="mailto:aninda400@gmail.com">
           Queries? Contact us
          </a>
      </div>
    </footer>

    <script>
    // Used to toggle the menu on small screens when clicking on the menu button
    function miniMenu() {
      var x = document.getElementById("miniMenu");
      if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
      } else {
        x.className = x.className.replace(" w3-show", "");
      }
    }

    function CheckId(){
        var xhttp = new XMLHttpRequest();

        xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
              var data = JSON.parse(this.responseText);
              var ID = data.ID;

              if(ID.includes("u")){
                console.log("check u");
                var x = document.getElementById("venueInfo");
                x.style.display = "none";
                x = document.getElementById("manage");
                x.style.display = "none";
                x = document.getElementById("healthSignUp");
                x.style.display = "none";
                x = document.getElementById("venueInfo2");
                x.style.display = "none";
                x = document.getElementById("manage2");
                x.style.display = "none";
                x = document.getElementById("healthSignUp2");
                x.style.display = "none";
              }
              else if(ID.includes("h")){
                console.log("check h");
                var t = document.getElementById("venueInfo");
                t.style.display = "none";
                t = document.getElementById("checkInHistory");
                t.style.display = "none";
                t = document.getElementById("venueInfo2");
                t.style.display = "none";
                t = document.getElementById("checkInHistory2");
                t.style.display = "none";

              }
              else if(ID.includes("v")){
                console.log("check v");
                var k = document.getElementById("manage");
                k.style.display = "none";
                k = document.getElementById("checkInHistory");
                k.style.display = "none";
                k = document.getElementById("healthSignUp");
                k.style.display = "none";
                k = document.getElementById("manage2");
                k.style.display = "none";
                k = document.getElementById("checkInHistory2");
                k.style.display = "none";
                k = document.getElementById("healthSignUp2");
                k.style.display = "none";
              }
            else{
              alert("Your ID has no set user type!!!!");
            }
          }
          else if(this.readyState == 4 && this.status >= 400){
            alert("failed");
          }
        };

        xhttp.open("GET", "/GettingId", true);
        // xhttp.setRequestHeader("Content-type", "application/json");
        //Send JSON containing new account data.
        xhttp.send();
      }

    </script>

    <!-- AJAX for adding new Health official to the DB -->
    <script>
      function RegisterHealth(){

        //Object for health official data.
        let healthOfficial = {
          firstName: document.getElementById('firstName').value,
          lastName: document.getElementById('lastName').value,
          email: document.getElementById('email').value,
          phoneNum: document.getElementById('phoneNum').value,
          password: document.getElementById('password').value,
          healthCode: document.getElementById('healthCode').value
        };

        var xhttp =  new XMLHttpRequest();

        xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
              //Reload the page once data has been put into the database (clears input fields).
              location.reload();
            }else if(this.readyState == 4 && this.status >= 400){
                alert("failed");
            }
        };

        xhttp.open("POST", "/healthSignUp", true);
        xhttp.setRequestHeader("Content-type", "application/json");
        //Send JSON containing new account data.
        xhttp.send(JSON.stringify(healthOfficial));

      }


      function logout(){

        // Create AJAX Request
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.open("POST", "/logout", true);
        xmlhttp.send();
      }

    </script>

  </body>
</html>